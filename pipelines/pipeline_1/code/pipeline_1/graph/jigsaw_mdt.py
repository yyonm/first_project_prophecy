from pyspark.sql import *
from pyspark.sql.functions import *
from pyspark.sql.types import *
from pipeline_1.config.ConfigStore import *
from pipeline_1.udfs.UDFs import *

def jigsaw_mdt(spark: SparkSession) -> DataFrame:
    return spark.read\
        .schema(
          StructType([
            StructField("tiempo_vacio", StringType(), True), StructField("total_tonelaje", StringType(), True), StructField("cut_dispatch", StringType(), True), StructField("cus_dispatch", StringType(), True), StructField("ley_a_usar", StringType(), True), StructField("ley_a_usar2", StringType(), True), StructField("ag_dispatch", StringType(), True), StructField("as_dispatch", StringType(), True), StructField("mo_dispatch", StringType(), True), StructField("sb_dispatch", StringType(), True), StructField("tons", StringType(), True), StructField("recup", StringType(), True), StructField("densidad", StringType(), True), StructField("rs_dispatch", StringType(), True), StructField("fet_dispatch", StringType(), True), StructField("pb_dispatch", StringType(), True), StructField("zn_dispatch", StringType(), True), StructField("bi_dispatch", StringType(), True), StructField("starkey_dispatch", StringType(), True), StructField("r_cu", StringType(), True), StructField("r_ag", StringType(), True), StructField("velsed_dispatch", StringType(), True), StructField("ys57_dispatch", StringType(), True), StructField("ys60_dispatch", StringType(), True), StructField("cut_modelo_bloque", StringType(), True), StructField("cus_modelo_bloque", StringType(), True), StructField("as_modelo_bloque", StringType(), True), StructField("ag_modelo_bloque", StringType(), True), StructField("mo_modelo_bloque", StringType(), True), StructField("sb_modelo_bloque", StringType(), True), StructField("fet_modelo_bloque", StringType(), True), StructField("pb_modelo_bloque", StringType(), True), StructField("zn_modelo_bloque", StringType(), True), StructField("gnd", StringType(), True), StructField("pmm", StringType(), True), StructField("and", StringType(), True), StructField("filica", StringType(), True), StructField("arg_av", StringType(), True), StructField("mp_montmorillonita", StringType(), True), StructField("mp_caolinita", StringType(), True), StructField("mp_caolinita_px", StringType(), True), StructField("mp_siderita", StringType(), True), StructField("mp_caolinita_wx", StringType(), True), StructField("mp_dickita", StringType(), True), StructField("mp_alunita", StringType(), True), StructField("mp_pirofilita", StringType(), True), StructField("mp_illita", StringType(), True), StructField("mp_musc-illitica", StringType(), True), StructField("mp_parag-illitica", StringType(), True), StructField("mp_paragonita", StringType(), True), StructField("mp_feng-illitica", StringType(), True), StructField("mp_fengita", StringType(), True), StructField("mp_muscovita", StringType(), True), StructField("mp_clorita_mg", StringType(), True), StructField("mp_clorita_int", StringType(), True), StructField("mp_clorita_fe", StringType(), True), StructField("cc", StringType(), True), StructField("cv", StringType(), True), StructField("bn", StringType(), True), StructField("en", StringType(), True), StructField("ten", StringType(), True), StructField("cp", StringType(), True), StructField("py", StringType(), True), StructField("tet", StringType(), True), StructField("esf", StringType(), True), StructField("starkey_modelo_bloque", StringType(), True), StructField("wi", StringType(), True), StructField("tcutr", StringType(), True), StructField("tcut", StringType(), True), StructField("tagr", StringType(), True), StructField("tag", StringType(), True), StructField("velsed_modelo_bloque", StringType(), True), StructField("ys57_modelo_bloque", StringType(), True), StructField("ys60_modelo_bloque", StringType(), True), StructField("tagr_r", StringType(), True), StructField("tasr_r", StringType(), True), StructField("tcutr_r", StringType(), True), StructField("tznr_r", StringType(), True), StructField("rec_ag_r", StringType(), True), StructField("rec_cut_r", StringType(), True), StructField("tonelaje_modelo_bloque", StringType(), True), StructField("rs_modelo_bloque", StringType(), True), StructField("fe/cu", StringType(), True), StructField("bi_modelo_bloque", StringType(), True), StructField("bignea", StringType(), True), StructField("bhidro", StringType(), True), StructField("crojo", StringType(), True), StructField("basand", StringType(), True), StructField("cmm", StringType(), True), StructField("vce", StringType(), True), StructField("sa", StringType(), True), StructField("silicificacion", StringType(), True), StructField("propilitico", StringType(), True), StructField("arg", StringType(), True), StructField("potasico", StringType(), True), StructField("mp_jarosita", StringType(), True), StructField("mp_halloysita", StringType(), True), StructField("mp_arcillas", StringType(), True), StructField("ms_montmorillonita", StringType(), True), StructField("ms_halloysita", StringType(), True), StructField("ms_caolinita", StringType(), True), StructField("ms_caolinitapx", StringType(), True), StructField("ms_side", StringType(), True), StructField("ms_ankerita", StringType(), True), StructField("ms_caolinitawx", StringType(), True), StructField("ms_dickita", StringType(), True), StructField("ms_nacrita", StringType(), True), StructField("ms_alunita", StringType(), True), StructField("ms_pirofilita", StringType(), True), StructField("ms_topacio", StringType(), True), StructField("ms_illita", StringType(), True), StructField("ms_musc-illitica", StringType(), True), StructField("ms_anhidrita", StringType(), True), StructField("ms_parag-illitica", StringType(), True), StructField("ms_paragonita", StringType(), True), StructField("ms_feng-illitica", StringType(), True), StructField("ms_fengita", StringType(), True), StructField("ms_muscovita", StringType(), True), StructField("ms_cloritamg", StringType(), True), StructField("ms_cloritaint", StringType(), True), StructField("ms_cloritafe", StringType(), True), StructField("ms_epidota", StringType(), True), StructField("ms_null", StringType(), True), StructField("ms_arcillas", StringType(), True), StructField("moli", StringType(), True), StructField("t_sulf", StringType(), True), StructField("goeth", StringType(), True), StructField("hem", StringType(), True), StructField("jar", StringType(), True), StructField("totlim", StringType(), True), StructField("ugst1", StringType(), True), StructField("ugst2", StringType(), True), StructField("ugst3", StringType(), True), StructField("ugst4", StringType(), True), StructField("ugst5", StringType(), True), StructField("ugwi1", StringType(), True), StructField("ugwi2", StringType(), True), StructField("ugwi3", StringType(), True), StructField("ugwi4", StringType(), True), StructField("ugwi5", StringType(), True), StructField("cuco_2017", StringType(), True), StructField("asco_est", StringType(), True), StructField("con_bo", StringType(), True), StructField("con_cc_cv", StringType(), True), StructField("con_cpy", StringType(), True), StructField("con_en_ten", StringType(), True), StructField("con_py", StringType(), True), StructField("con_tetra", StringType(), True), StructField("recpy", StringType(), True), StructField("insoluble", StringType(), True), StructField("rcu", StringType(), True), StructField("rag", StringType(), True), StructField("tastr", StringType(), True), StructField("tas", StringType(), True), StructField("ras", StringType(), True), StructField("tznr", StringType(), True), StructField("tzn", StringType(), True), StructField("rzn", StringType(), True), StructField("ugrcut1", StringType(), True), StructField("ugrcut2", StringType(), True), StructField("ugrcut3", StringType(), True), StructField("ugrcut4", StringType(), True), StructField("ugrcut5", StringType(), True), StructField("ugras1", StringType(), True), StructField("ugras2", StringType(), True), StructField("ugras3", StringType(), True), StructField("ugras4", StringType(), True), StructField("ugras5", StringType(), True), StructField("ugrag1", StringType(), True), StructField("ugrag2", StringType(), True), StructField("ugrag3", StringType(), True), StructField("ugrag4", StringType(), True), StructField("ugrag5", StringType(), True), StructField("ugrag6", StringType(), True), StructField("ugrzn1", StringType(), True), StructField("ugrzn2", StringType(), True), StructField("ugrzn3", StringType(), True), StructField("ugvs1", StringType(), True), StructField("ugvs23", StringType(), True), StructField("ugvs4", StringType(), True), StructField("ugvs5", StringType(), True), StructField("ugvs6", StringType(), True), StructField("ugys1", StringType(), True), StructField("ugys2", StringType(), True), StructField("ugys3", StringType(), True), StructField("ugys4", StringType(), True), StructField("ugys5", StringType(), True), StructField("ugys6", StringType(), True), StructField("perc_tonelaje_stock", StringType(), True), StructField("perc_tonelaje_mina", StringType(), True), StructField("perc_tonelaje_icv", StringType(), True), StructField("perc_tonelaje_no_icv", StringType(), True), StructField("cut_dispatch_stock", StringType(), True), StructField("cut_dispatch_mina", StringType(), True), StructField("cut_mb_fillz", StringType(), True), StructField("cut_dis_fillz", StringType(), True), StructField("year", StringType(), True), StructField("month", StringType(), True), StructField("day", StringType(), True)
        ])
        )\
        .option("header", True)\
        .option("sep", ",")\
        .csv("dbfs:/mnt/refined/dmh/operaciones/jigsaw/vistas/var_agg_1_hr/EXPORT/jigsaw_mdt.csv")
