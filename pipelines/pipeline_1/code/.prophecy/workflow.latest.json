{
  "metainfo" : {
    "id" : "1",
    "language" : "python",
    "fabricId" : "1084",
    "frontEndLanguage" : "sql",
    "mode" : "batch",
    "udfs" : {
      "language" : "python",
      "udfs" : [ ]
    },
    "udafs" : {
      "language" : "python",
      "code" : ""
    },
    "configuration" : {
      "common" : {
        "type" : "record",
        "fields" : [ ]
      },
      "fabrics" : { },
      "instances" : { },
      "selected" : "default"
    },
    "sparkConf" : [ ],
    "hadoopConf" : [ ],
    "codeMode" : "sparse",
    "buildSystem" : "maven",
    "externalDependencies" : [ ],
    "isImported" : false,
    "interimMode" : "Full",
    "interimModeEnabled" : true,
    "visualCodeInterimMode" : "Disabled",
    "recordsLimit" : {
      "enabled" : false,
      "value" : 1000
    },
    "topLevelPackage" : "pipeline_1"
  },
  "connections" : [ {
    "id" : "uYFjnCP3_JfKGDGUdX39g",
    "source" : "dCXcYWDQbz1pf7uhvF26J$$dkZ1ux3LA9DedjwvYtwkl",
    "sourcePort" : "K8XFhdKatRdsidOGVB2P1$$CHnuZexwDrkGvdIY_IBDy",
    "target" : "VX3ptB8F295W44vBDSb0f$$xhy_VPWOHlXed_Es5o0rw",
    "targetPort" : "0l5bEteDJK9FKR6zqYX62$$2Qy-FI77TXDqsxpoCrUJo"
  }, {
    "id" : "lprngX4J6vF5u9Ed_89lZ",
    "source" : "Wv2lfVPevUII6N-IqN9Z9$$oOWTQRp0-A0JVNETuQTx8",
    "sourcePort" : "RPCT4MhpfeSGY69VwVjlD$$G5fiFR2yGwjgJhzZf555k",
    "target" : "zAm5FTyATNy8NiudI0lfc$$Mh3JvEMofykPqI17gCUfL",
    "targetPort" : "HcVFK_Ox7YRMKWXUdp5kw$$f3Y0A3czG1Qe2JqOutF4d"
  }, {
    "id" : "tWqyUC6xHsXPwftjfNhNd",
    "source" : "feNwb3T5sHZa63uQSlIEg$$vBntB-Kj811lCxtmG1cRq",
    "sourcePort" : "4UtoHngomuVaXtj6NAteA$$f_Qq1adTo20NCntRZgmy8",
    "target" : "fcDi0XPmfPiJ22QYjau1G$$wtmPYYujtN91g4K1eutKY",
    "targetPort" : "-1-3KPSFUHyHThEHNXTIc$$jFeBemrT8SpzS6Xgbn2Mk"
  }, {
    "id" : "C_IaFT7VAEEI3QNxamPDp",
    "source" : "fcDi0XPmfPiJ22QYjau1G$$wtmPYYujtN91g4K1eutKY",
    "sourcePort" : "GdqmiBe8at9MUUL20yDBi$$09XAyT0G6O5xhk-UQWXYx",
    "target" : "4vqreBlOMItAWbTBs6c0k$$NoiD7I2pwrUHmNRlm63XB",
    "targetPort" : "ezxvSzZPTgdtZzQNqtmHo$$Ia0o1GfLaqY0mqF4mpiCT"
  }, {
    "id" : "A29br9GulUaBy4I82UY82",
    "source" : "zAm5FTyATNy8NiudI0lfc$$Mh3JvEMofykPqI17gCUfL",
    "sourcePort" : "YEB2lFSNzQJUQ78m0UbM1$$9X2-ecxlBPj5_XX-CiCR5",
    "target" : "U9r8nbTlsfJCnSHg8dqG_$$SPS8e6RZcx5Rh4pgSsaDy",
    "targetPort" : "mIsFeZl_trHh9rtypHrOi$$PJZ6yMIyZLhtvE2kP_6Fn"
  }, {
    "id" : "uggZm78WqZtDnyM3QASiZ",
    "source" : "4vqreBlOMItAWbTBs6c0k$$NoiD7I2pwrUHmNRlm63XB",
    "sourcePort" : "ZNhpDRQ7r0NLhCYqEAhDc$$775ns_yE1wXWbQ06YJdBf",
    "target" : "R8-eGC0LbiE7Mjno_TGY2$$5_e9RJD28GHvZgLEcaYhm",
    "targetPort" : "trzJbagmFDDkKf1uQRDHc$$Djoxk2Y2hdky4ZCbC4WLU"
  }, {
    "id" : "XNEceCD1H5xggCF7UZD__",
    "source" : "R8-eGC0LbiE7Mjno_TGY2$$5_e9RJD28GHvZgLEcaYhm",
    "sourcePort" : "EXzvg-11ph8VE_9vvzov2$$RIZOJRir-1CrYZmTsQs0I",
    "target" : "3sMI0gq6CVOvRUjvDrcJz$$0Tpt3JuFr5rW-rOzmYgvQ",
    "targetPort" : "QHGoq2O4ALtQPVc_aNX13$$bpl4r9wscbPN_F6PuVap7"
  }, {
    "id" : "U2bvaafgYUz2tZkqrAsXn",
    "source" : "U9r8nbTlsfJCnSHg8dqG_$$SPS8e6RZcx5Rh4pgSsaDy",
    "sourcePort" : "lsMXPlm38mUq5j7uxul9l$$FtL2XP6V1zxjRPHmZKsKt",
    "target" : "R8-eGC0LbiE7Mjno_TGY2$$5_e9RJD28GHvZgLEcaYhm",
    "targetPort" : "_xbmqVULimoff2pmq5Yif$$sotuGYSGe4sCVeAYDUv87"
  } ],
  "processes" : {
    "6nYJTn19bVqbkOcn1dWjW$$JFL4qNeEnulw-A1scEpMv" : {
      "id" : "6nYJTn19bVqbkOcn1dWjW$$JFL4qNeEnulw-A1scEpMv",
      "component" : "DeltaTableOperations",
      "metadata" : {
        "label" : "optimize_refined_jigsaw",
        "slug" : "optimize_refined_jigsaw",
        "x" : -302.8000000000002,
        "y" : 184.00000000000006,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "database" : "dmh_minco",
        "path" : "dbfs:/mnt/refined/dmh/operaciones/jigsaw/vistas/var_agg_1_hr/OUT",
        "updateCondition" : null,
        "restoreValue" : null,
        "vaccumRetainNumHours" : null,
        "useOptimiseZOrder" : true,
        "tableName" : "table_refined_jigsaw",
        "restoreVia" : null,
        "optimiseWhere" : null,
        "updateTableExpressions" : [ ],
        "useExternalFilePath" : false,
        "deleteCondition" : {
          "format" : "sql",
          "expression" : "true"
        },
        "optimiseZOrderColumns" : [ {
          "colName" : "tiempo_vacio"
        } ],
        "useOptimiseWhere" : false,
        "action" : "optimiseTable"
      }
    },
    "VX3ptB8F295W44vBDSb0f$$xhy_VPWOHlXed_Es5o0rw" : {
      "id" : "VX3ptB8F295W44vBDSb0f$$xhy_VPWOHlXed_Es5o0rw",
      "component" : "Reformat",
      "metadata" : {
        "label" : "reformat_tiempo_vacio",
        "slug" : "reformat_tiempo_vacio",
        "x" : -113.60000000000002,
        "y" : 5.200000000000017,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "0l5bEteDJK9FKR6zqYX62$$2Qy-FI77TXDqsxpoCrUJo",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "v0aPPQ-mEHzA6pck1J69_$$l-PRX7Aj2ZXq27zOB1t84",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "importLanguage" : "python",
        "expressions" : [ {
          "target" : "tiempo_vacio_ts",
          "expression" : {
            "format" : "sql",
            "expression" : "to_timestamp(tiempo_vacio, 'yyyy-MM-dd HH:mm:ss')"
          },
          "description" : ""
        } ],
        "importString" : "",
        "activeTab" : "expressions",
        "columnsSelector" : [ "0l5bEteDJK9FKR6zqYX62$$2Qy-FI77TXDqsxpoCrUJo##tiempo_vacio" ]
      }
    },
    "U9r8nbTlsfJCnSHg8dqG_$$SPS8e6RZcx5Rh4pgSsaDy" : {
      "id" : "U9r8nbTlsfJCnSHg8dqG_$$SPS8e6RZcx5Rh4pgSsaDy",
      "component" : "SchemaTransform",
      "metadata" : {
        "label" : "SchemaTransform_2",
        "slug" : "SchemaTransform_2",
        "x" : 44.81250000000017,
        "y" : -135.1999999999999,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "mIsFeZl_trHh9rtypHrOi$$PJZ6yMIyZLhtvE2kP_6Fn",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "lsMXPlm38mUq5j7uxul9l$$FtL2XP6V1zxjRPHmZKsKt",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "columnsSelector" : [ "mIsFeZl_trHh9rtypHrOi$$PJZ6yMIyZLhtvE2kP_6Fn##tag" ],
        "transformations" : [ {
          "kind" : "RenameColumn",
          "RenameColumn" : {
            "sourceColumn" : "tag",
            "targetColumn" : "tag_landing"
          },
          "DropColumn" : {
            "sourceColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "",
            "expression" : {
              "expression" : "",
              "format" : "python"
            }
          }
        } ]
      }
    },
    "R8-eGC0LbiE7Mjno_TGY2$$5_e9RJD28GHvZgLEcaYhm" : {
      "id" : "R8-eGC0LbiE7Mjno_TGY2$$5_e9RJD28GHvZgLEcaYhm",
      "component" : "Join",
      "metadata" : {
        "label" : "Join_1",
        "slug" : "Join_1",
        "x" : 227.87500000000034,
        "y" : -296.4000000000001,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "trzJbagmFDDkKf1uQRDHc$$Djoxk2Y2hdky4ZCbC4WLU",
          "slug" : "in0"
        }, {
          "id" : "_xbmqVULimoff2pmq5Yif$$sotuGYSGe4sCVeAYDUv87",
          "slug" : "in1"
        } ],
        "outputs" : [ {
          "id" : "EXzvg-11ph8VE_9vvzov2$$RIZOJRir-1CrYZmTsQs0I",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "in1",
          "expression" : {
            "format" : "sql",
            "expression" : "in0.tag == in1.tag_landing"
          },
          "joinType" : "inner"
        } ],
        "expressions" : [ ],
        "hints" : [ {
          "id" : "trzJbagmFDDkKf1uQRDHc$$Djoxk2Y2hdky4ZCbC4WLU",
          "alias" : "in0",
          "hintType" : "none",
          "propagateColumns" : false
        }, {
          "id" : "_xbmqVULimoff2pmq5Yif$$sotuGYSGe4sCVeAYDUv87",
          "alias" : "in1",
          "hintType" : "none",
          "propagateColumns" : false
        } ],
        "allIn1" : null,
        "activeTab" : "conditions",
        "columnsSelector" : [ "_xbmqVULimoff2pmq5Yif$$sotuGYSGe4sCVeAYDUv87##tag_landing", "trzJbagmFDDkKf1uQRDHc$$Djoxk2Y2hdky4ZCbC4WLU##tag" ],
        "allIn0" : null,
        "whereClause" : null,
        "headAlias" : "in0"
      }
    },
    "fcDi0XPmfPiJ22QYjau1G$$wtmPYYujtN91g4K1eutKY" : {
      "id" : "fcDi0XPmfPiJ22QYjau1G$$wtmPYYujtN91g4K1eutKY",
      "component" : "Filter",
      "metadata" : {
        "label" : "Filter_1",
        "slug" : "Filter_1",
        "x" : -153.72499999999985,
        "y" : -310.79999999999995,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "-1-3KPSFUHyHThEHNXTIc$$jFeBemrT8SpzS6Xgbn2Mk",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "GdqmiBe8at9MUUL20yDBi$$09XAyT0G6O5xhk-UQWXYx",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "columnsSelector" : [ "-1-3KPSFUHyHThEHNXTIc$$jFeBemrT8SpzS6Xgbn2Mk##division" ],
        "condition" : {
          "format" : "sql",
          "expression" : "division == 'DMH'"
        }
      }
    },
    "Wv2lfVPevUII6N-IqN9Z9$$oOWTQRp0-A0JVNETuQTx8" : {
      "id" : "Wv2lfVPevUII6N-IqN9Z9$$oOWTQRp0-A0JVNETuQTx8",
      "component" : "Source",
      "metadata" : {
        "label" : "pisystem_landing",
        "slug" : "pisystem_landing",
        "x" : -308.19999999999993,
        "y" : -142.79999999999993,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "RPCT4MhpfeSGY69VwVjlD$$G5fiFR2yGwjgJhzZf555k",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "datasetId" : "3633/datasets/pisystem_landing"
      }
    },
    "dCXcYWDQbz1pf7uhvF26J$$dkZ1ux3LA9DedjwvYtwkl" : {
      "id" : "dCXcYWDQbz1pf7uhvF26J$$dkZ1ux3LA9DedjwvYtwkl",
      "component" : "Source",
      "metadata" : {
        "label" : "jigsaw_mdt",
        "slug" : "jigsaw_mdt",
        "x" : -301.6,
        "y" : 11.200000000000017,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "K8XFhdKatRdsidOGVB2P1$$CHnuZexwDrkGvdIY_IBDy",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "datasetId" : "3633/datasets/jigsaw_mdt"
      }
    },
    "3sMI0gq6CVOvRUjvDrcJz$$0Tpt3JuFr5rW-rOzmYgvQ" : {
      "id" : "3sMI0gq6CVOvRUjvDrcJz$$0Tpt3JuFr5rW-rOzmYgvQ",
      "component" : "Target",
      "metadata" : {
        "label" : "pisystem_join_to_delta",
        "slug" : "pisystem_join_to_delta",
        "x" : 399.47500000000025,
        "y" : -301.20000000000005,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "QHGoq2O4ALtQPVc_aNX13$$bpl4r9wscbPN_F6PuVap7",
          "slug" : "in0"
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "datasetId" : "3633/datasets/pisystem_join_to_delta"
      }
    },
    "feNwb3T5sHZa63uQSlIEg$$vBntB-Kj811lCxtmG1cRq" : {
      "id" : "feNwb3T5sHZa63uQSlIEg$$vBntB-Kj811lCxtmG1cRq",
      "component" : "Source",
      "metadata" : {
        "label" : "diccionario",
        "slug" : "diccionario",
        "x" : -312.25,
        "y" : -313.19999999999993,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "4UtoHngomuVaXtj6NAteA$$f_Qq1adTo20NCntRZgmy8",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "datasetId" : "3633/datasets/diccionario"
      }
    },
    "4vqreBlOMItAWbTBs6c0k$$NoiD7I2pwrUHmNRlm63XB" : {
      "id" : "4vqreBlOMItAWbTBs6c0k$$NoiD7I2pwrUHmNRlm63XB",
      "component" : "SchemaTransform",
      "metadata" : {
        "label" : "SchemaTransform_1",
        "slug" : "SchemaTransform_1",
        "x" : 34.57708333333352,
        "y" : -308.8,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "ezxvSzZPTgdtZzQNqtmHo$$Ia0o1GfLaqY0mqF4mpiCT",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "ZNhpDRQ7r0NLhCYqEAhDc$$775ns_yE1wXWbQ06YJdBf",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false
      },
      "properties" : {
        "columnsSelector" : [ "ezxvSzZPTgdtZzQNqtmHo$$Ia0o1GfLaqY0mqF4mpiCT##units", "ezxvSzZPTgdtZzQNqtmHo$$Ia0o1GfLaqY0mqF4mpiCT##point_type", "ezxvSzZPTgdtZzQNqtmHo$$Ia0o1GfLaqY0mqF4mpiCT##digital_set", "ezxvSzZPTgdtZzQNqtmHo$$Ia0o1GfLaqY0mqF4mpiCT##division", "ezxvSzZPTgdtZzQNqtmHo$$Ia0o1GfLaqY0mqF4mpiCT##description", "ezxvSzZPTgdtZzQNqtmHo$$Ia0o1GfLaqY0mqF4mpiCT##server" ],
        "transformations" : [ {
          "kind" : "DropColumn",
          "DropColumn" : {
            "sourceColumn" : "division"
          },
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "",
            "expression" : {
              "expression" : "",
              "format" : "python"
            }
          }
        }, {
          "kind" : "DropColumn",
          "DropColumn" : {
            "sourceColumn" : "server"
          },
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "",
            "expression" : {
              "expression" : "",
              "format" : "python"
            }
          }
        }, {
          "kind" : "DropColumn",
          "DropColumn" : {
            "sourceColumn" : "units"
          },
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "",
            "expression" : {
              "expression" : "",
              "format" : "python"
            }
          }
        }, {
          "kind" : "DropColumn",
          "DropColumn" : {
            "sourceColumn" : "point_type"
          },
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "",
            "expression" : {
              "expression" : "",
              "format" : "python"
            }
          }
        }, {
          "kind" : "DropColumn",
          "DropColumn" : {
            "sourceColumn" : "digital_set"
          },
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "",
            "expression" : {
              "expression" : "",
              "format" : "python"
            }
          }
        }, {
          "kind" : "DropColumn",
          "DropColumn" : {
            "sourceColumn" : "description"
          },
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "",
            "expression" : {
              "expression" : "",
              "format" : "python"
            }
          }
        }, {
          "kind" : "DropColumn",
          "DropColumn" : {
            "sourceColumn" : "digital_mapping"
          },
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "",
            "expression" : {
              "expression" : "",
              "format" : "python"
            }
          }
        }, {
          "kind" : "DropColumn",
          "DropColumn" : {
            "sourceColumn" : "aggregation_mapping"
          },
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "",
            "expression" : {
              "expression" : "",
              "format" : "python"
            }
          }
        } ]
      }
    },
    "zAm5FTyATNy8NiudI0lfc$$Mh3JvEMofykPqI17gCUfL" : {
      "id" : "zAm5FTyATNy8NiudI0lfc$$Mh3JvEMofykPqI17gCUfL",
      "component" : "Deduplicate",
      "metadata" : {
        "label" : "Deduplicate_1",
        "slug" : "Deduplicate_1",
        "x" : -142.2,
        "y" : -133.59999999999997,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false
      },
      "ports" : {
        "inputs" : [ {
          "id" : "HcVFK_Ox7YRMKWXUdp5kw$$f3Y0A3czG1Qe2JqOutF4d",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "YEB2lFSNzQJUQ78m0UbM1$$9X2-ecxlBPj5_XX-CiCR5",
          "slug" : "out",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "server",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "tag",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "timestamp_ts",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          }
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true
      },
      "properties" : {
        "dedupColumns" : [ {
          "colName" : "tag"
        } ],
        "dedupType" : "unique_only",
        "columnsSelector" : [ "HcVFK_Ox7YRMKWXUdp5kw$$f3Y0A3czG1Qe2JqOutF4d##tag" ],
        "orders" : [ ],
        "useOrderBy" : false
      }
    }
  },
  "ports" : {
    "inputs" : [ ],
    "outputs" : [ ],
    "selectedInputFields" : [ ],
    "isCustomOutputSchema" : false
  }
}